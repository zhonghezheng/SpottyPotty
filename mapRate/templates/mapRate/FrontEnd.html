<html>
  <head>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css"
    integrity="sha512-hoalWLoI8r4UszCkZ5kL8vayOGVae1oxXe/2A4AO6J9+580uKHDO3JdHb7NzwwzK5xr/Fs0W40kiNHxM9vyTtQ=="
    crossorigin=""/>

    <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js"
    integrity="sha512-BB3hKbKWOc9Ez/TAwyWxNXeoV9c1v6FIeYiBieIWkpLjauysF18NzgR1MBNBXf8/KABdlkX68nAhlwcDFLGPCQ=="
    crossorigin=""></script>

    <link rel="stylesheet" href="../../static/mapRate/Map.css">

  </head>

  <body>

    <div id="sidemap">
      <h2> Filter </h2>
        <p>Gender</p>
        <div id="gender">
          Men: <input type="checkbox" id="men">
          Women: <input type="checkbox" id="women">
          Gender Neutral: <input type="checkbox" id="genderNeutral">
        </div>

        <br>

        <p>Distance</p>
        <div id="distance">
          <input type="range" min="1" max="10" value="5" id="slider_distance">
          <p>Distance: <span id="slider_val"></span></p>
        </div>

        <br>

        <p>Hygene Products</p>
        <div id="hygene">
          Free: <input type="checkbox" id="freeHygiene">
          Paid: <input type="checkbox" id="paidHygiene">
        </div>

        <br>
        
        <p>Rating</p>
        <div id="rating">
          <input type="range" min="1" max="5" value="5" id="sliderRate_distance">
          <p>Rating: <span id="sliderRate_val"></span></p>
        </div>

        <br>
        <button id="EnterBtn" onclick="buttonClicked()">Enter</button>

    </div>

    <script>
      var men = document.getElementById("men");
      var women = document.getElementById("women");
      var inclusive = document.getElementById("genderNeutral");
      var freeHygiene = document.getElementById("freeHygiene");
      var paidHygiene = document.getElementById("paidHygiene");

      var slider = document.getElementById("slider_distance");
      var output = document.getElementById("slider_val");
      output.innerHTML = slider.value;

      var sliderRate = document.getElementById("sliderRate_distance");
      var outputRate = document.getElementById("sliderRate_val");
      outputRate.innerHTML = sliderRate.value;

      slider.oninput = function() 
      {
        output.innerHTML = this.value;
      }

      sliderRate.oninput = function() 
      {
        outputRate.innerHTML = this.value;
      }

      function buttonClicked()
      {
        var form = document.createElement('form');
        form.innerHTML = '<input type= "filter"'+' men = "'+men.checked+ '" women = "' + women.checked + '" inclusive = "' +inclusive.checked +'" freeHygiene="' + freeHygiene.checked + '" paidHygiene="' + paidHygiene.checked +'" Distance="' +slider.value+'" Rating="'+ sliderRate.value+'" >';
        console.log(form); 
      }
      
    </script>




    <div id="map"></div>


    <script>
      var map = L.map('map').setView([33.646, -117.843], 17);

      L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
        maxZoom: 19,
        minZoom: 17,
        id: 'mapbox/streets-v11',
        tileSize: 512,
        zoomOffset: -1,
        accessToken: 'pk.eyJ1IjoiY2F0aGVyaW5lMTAzMDEiLCJhIjoiY2wzZmY1OGp6MDU2NDNjbHE5dHRld2U4cSJ9.vtDWqK9r4idKKgr9thStKQ'
      }).addTo(map);

      function OpenModal()
      {
        
        var popup = document.createElement('div');
        popup.className = 'popup';
        popup.id = 'test';
        var cancel = document.createElement('div');
        cancel.className = 'cancel';
        cancel.innerHTML = 'close';
        cancel.onclick = function (e) { popup.parentNode.removeChild(popup) };
        var message = document.createElement('p');
        message.innerHTML = "This is a test message";
        popup.appendChild(message);                                    
        popup.appendChild(cancel);
        document.body.appendChild(popup);
        console.log(popup);
      }
    </script>
    
    <ul>
      {% for pin in pins %}
        <script>
          // TODO: change garbage name string
          var name = "hello"; // should be in the format {{pin.name}}
          // WE NEED THE AVERAGES OF ALL BATHROOMS IN LOCATION
          var average = 4; // should be in the format {{pin.average}}

          var popup = '<center><b>Donald Bren Hall</b></center>';
          popup += 'Rating: 4.23<br>'; // CONSIDER CHANGING THIS TO VISUAL STARS

          popup += '<button style="float:right" onclick="OpenModal()">more</button><br>'

          var pin = L.marker(['{{pin.latitude}}', '{{pin.longitude}}'],
          {alt: name, title: name}).addTo(map)
          .bindPopup(popup);
        </script>
      {% endfor %}
    </ul>
  </body>
</html>